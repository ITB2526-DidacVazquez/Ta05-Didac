<!doctype html>
<html lang="es">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width,initial-scale=1">
  <title>Proyecto 2 - Dashboard SIEM</title>
  <link rel="stylesheet" href="estilos.css">
  <link rel="icon" type="image/png" href="mi-logo.png">
  <style>
    /* =========================================================
       1. AJUSTES DEL HEADER (Igual que Proyecto 1)
       ========================================================= */
    header {
        display: flex;
        flex-wrap: wrap; 
        justify-content: space-between;
        align-items: center;
        padding: 20px;
        gap: 20px;
    }

    header h1 {
        margin: 0;
        flex-grow: 1;
        min-width: 250px;
    }

    .header-controls {
        display: flex;
        align-items: center;
        gap: 20px;
        flex-wrap: wrap;
        justify-content: center;
    }

    /* =========================================================
       2. ESTRUCTURA LAYOUT (SIDEBAR + CONTENIDO)
       ========================================================= */
    .app-layout {
        display: flex; /* Flexbox para poner menú y dashboard lado a lado */
        max-width: 1200px; /* Un poco más ancho para que quepa bien la gráfica */
        margin: 20px auto;
        gap: 20px;
        padding: 0 10px;
    }

    /* Estilos del Menú Lateral (Navigator) */
    .sidebar {
        width: 200px; /* Ancho fijo */
        background: #0c0c0c;
        border: 1px solid #333;
        border-radius: 5px;
        padding: 15px;
        height: fit-content;
        font-family: 'Courier New', monospace;
        flex-shrink: 0; /* Evita que el menú se aplaste */
    }

    .sidebar h3 {
        color: #ccc;
        margin-top: 0;
        margin-bottom: 15px;
        font-size: 1rem;
        border-bottom: 1px solid #333;
        padding-bottom: 10px;
        font-family: 'Orbitron', sans-serif;
    }

    .nav-link {
        display: block;
        color: #00f2ff;
        text-decoration: none;
        padding: 10px;
        margin-bottom: 5px;
        border-left: 2px solid transparent;
        transition: all 0.3s ease;
        font-weight: bold;
    }

    .nav-link:hover, .nav-link.active {
        background: rgba(0, 242, 255, 0.1);
        border-left: 2px solid #00f2ff;
        color: #fff;
    }

    .arrow { float: right; }

    /* Contenedor Derecho (Donde va el Dashboard) */
    .content-area {
        flex: 1; /* Ocupa el resto del espacio */
        min-width: 0; /* IMPORTANTE: Evita desbordamiento de grid dentro de flex */
    }

    /* =========================================================
       3. ESTILOS DEL DASHBOARD (Tus estilos originales)
       ========================================================= */
    .dashboard-grid {
        display: grid;
        grid-template-columns: 2fr 1fr;
        gap: 20px;
        margin-top: 20px;
    }

    .panel {
        background: rgba(0, 0, 0, 0.4);
        border: 1px solid #333;
        border-radius: 8px;
        padding: 15px;
        box-shadow: 0 0 10px rgba(0, 242, 255, 0.05);
    }

    h2 { font-family: 'Orbitron', sans-serif; margin-bottom: 10px; color: white; }
    
    /* Ajuste para los títulos de los paneles */
    .panel h3 {
        color: #00f2ff;
        font-family: 'Orbitron', sans-serif;
        margin-bottom: 15px;
        border-bottom: 1px solid #333;
        padding-bottom: 5px;
        font-size: 1rem;
    }

    #trafficChart {
        width: 100%;
        height: 250px;
        background: #050510;
        border: 1px solid #333;
    }

    .log-list {
        height: 250px;
        overflow-y: auto;
        font-family: 'Courier New', monospace;
        font-size: 0.8rem;
    }
    
    .log-item {
        margin-bottom: 8px;
        padding-bottom: 5px;
        border-bottom: 1px solid #222;
        display: flex;
        justify-content: space-between;
    }

    .status-badge {
        display: inline-block;
        padding: 5px 10px;
        border-radius: 4px;
        font-size: 0.8rem;
        font-weight: bold;
        margin-right: 10px;
        background: #111;
    }
    .status-ok { border: 1px solid #00ff41; color: #00ff41; }
    .status-warn { border: 1px solid #ffcc00; color: #ffcc00; }
    .status-crit { border: 1px solid #ff3333; color: #ff3333; }

    .code-block {
        background: #0c0c0c;
        padding: 15px;
        border-radius: 5px;
        font-family: 'Courier New', monospace;
        font-size: 0.85rem;
        color: #ccc;
        border-left: 3px solid #bc13fe;
        overflow-x: auto;
    }
    .keyword { color: #bc13fe; }
    .string { color: #00ff41; }
    .comment { color: #666; font-style: italic; }

    @media (max-width: 900px) {
        .app-layout { flex-direction: column; }
        .sidebar { width: 100%; box-sizing: border-box; }
        .dashboard-grid { grid-template-columns: 1fr; }
    }

    @media (max-width: 768px) {
        header { flex-direction: column; align-items: flex-start; }
        .header-controls { width: 100%; justify-content: space-between; margin-top: 10px; }
    }

    /* =========================================================
       4. ESTILOS DEL TRADUCTOR
       ========================================================= */
    .translator-box { position: static; z-index: 1000; }
    .goog-te-banner-frame.skiptranslate { display: none !important; } 
    body { top: 0px !important; }

    .goog-te-gadget-simple {
        background-color: rgba(0, 0, 0, 0.7) !important;
        border: 1px solid #bc13fe !important;
        padding: 8px 12px !important;
        border-radius: 0 !important;
        font-family: 'Orbitron', sans-serif !important;
        transition: all 0.3s ease;
    }

    .goog-te-gadget-simple:hover {
        background: rgba(188, 19, 254, 0.2) !important;
        box-shadow: 0 0 10px #bc13fe;
    }
    .goog-te-gadget-simple span { color: #fff !important; font-size: 14px !important; font-weight: bold; }
    .goog-te-menu-value span { color: #00f2ff !important; border-left: none !important; }
    .goog-te-gadget-icon { display: none !important; }

  </style>
</head>
<body>
  
  <header>
    <h1><a href="index.html" style="text-decoration:none; color:inherit;">VOLVER AL MENU</a></h1>
    
    <div class="header-controls">
        <nav class="main-nav">
          <a href="index.html">Inicio</a>
          <a href="contacto.html">Contacto</a>
        </nav>
        
        <div id="google_translate_element" class="translator-box"></div>
    </div>
  </header>

  <main>
    <div class="app-layout">
        
        <aside class="sidebar">
            <h3>Navigator</h3>
            <a href="proyecto1.html" class="nav-link">
                Link: Project 1 <span class="arrow">&gt;</span>
            </a>
            <a href="proyecto2.html" class="nav-link active">
                Link: Project 2 <span class="arrow">&gt;</span>
            </a>
        </aside>

        <div class="content-area">
            <div style="background: rgba(0,0,0,0.3); padding: 20px; border-radius: 15px; border: 1px solid var(--primary);">
                <h2>DASHBOARD DE MONITORIZACIÓN DE RED (SIEM)</h2>
                <p style="color: #ccc; margin-bottom: 20px;">
                    Este panel simula la visualización de tráfico en tiempo real y la detección de intrusiones (IDS). 
                    Como administrador, herramientas como <strong>Wazuh</strong>, <strong>Splunk</strong> o scripts personalizados en <strong>Python</strong> son esenciales para mantener la integridad de la infraestructura.
                </p>

                <div class="dashboard-grid">
                    
                    <div class="panel">
                        <h3>TRÁFICO DE RED (LIVE PACKETS)</h3>
                        <canvas id="trafficChart"></canvas>
                        
                        <div style="margin-top: 20px; display: flex; justify-content: space-around; flex-wrap: wrap; gap:10px;">
                            <div class="status-badge status-ok">FIREWALL: ACTIVO</div>
                            <div class="status-badge status-ok">IDS: MONITORIZANDO</div>
                            <div class="status-badge status-warn">LOAD: 78%</div>
                        </div>
                    </div>

                    <div class="panel">
                        <h3>ÚLTIMAS ALERTAS DE SEGURIDAD</h3>
                        <div class="log-list" id="logContainer">
                            <div class="log-item"><span style="color:#00ff41">[INFO]</span> <span>System Boot complete</span></div>
                        </div>
                    </div>

                </div>

                <div class="panel" style="margin-top: 20px;">
                    <h3>AUTOMATIZACIÓN: PYTHON LOG PARSER (SNIPPET)</h3>
                    <p style="font-size: 0.9rem; color: #aaa; margin-bottom: 10px;">Ejemplo de cómo un script analiza logs buscando intentos de fuerza bruta:</p>
                    <div class="code-block">
<span class="keyword">import</span> re
<span class="keyword">from</span> datetime <span class="keyword">import</span> datetime

<span class="comment"># Función para detectar intentos fallidos de SSH</span>
<span class="keyword">def</span> <span class="function">analyze_auth_log</span>(logfile):
    suspicious_ips = {}
    <span class="keyword">with</span> open(logfile, <span class="string">'r'</span>) <span class="keyword">as</span> f:
        <span class="keyword">for</span> line <span class="keyword">in</span> f:
            <span class="keyword">if</span> <span class="string">"Failed password"</span> <span class="keyword">in</span> line:
                ip = re.search(<span class="string">r'\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}'</span>, line).group()
                suspicious_ips[ip] = suspicious_ips.get(ip, 0) + 1
                
    <span class="keyword">return</span> suspicious_ips
                    </div>
                </div>

            </div>
        </div> </div> </main>

  <script>
    // --- 1. LÓGICA DE LA GRÁFICA DE TRÁFICO (Canvas) ---
    const canvas = document.getElementById('trafficChart');
    const ctx = canvas.getContext('2d');
    
    // Función para redimensionar el canvas dinámicamente
    function resizeCanvas() {
        canvas.width = canvas.offsetWidth;
        canvas.height = canvas.offsetHeight;
    }
    // Llamar al inicio y si cambia el tamaño de ventana
    resizeCanvas();
    window.addEventListener('resize', resizeCanvas);

    let dataPoints = [];
    const maxPoints = 50;

    function drawChart() {
        // Limpiar
        ctx.fillStyle = '#050510';
        ctx.fillRect(0, 0, canvas.width, canvas.height);

        // Generar dato aleatorio (Simulando tráfico Mbps)
        let traffic = Math.floor(Math.random() * 50) + 20; 
        // Ocasionalmente un pico alto (DDoS simulation)
        if(Math.random() > 0.95) traffic = Math.floor(Math.random() * 80) + 80;

        dataPoints.push(traffic);
        if(dataPoints.length > maxPoints) dataPoints.shift();

        // Dibujar rejilla
        ctx.strokeStyle = '#222';
        ctx.beginPath();
        for(let i=0; i<canvas.width; i+=40) { ctx.moveTo(i,0); ctx.lineTo(i, canvas.height); }
        for(let i=0; i<canvas.height; i+=40) { ctx.moveTo(0,i); ctx.lineTo(canvas.width, i); }
        ctx.stroke();

        // Dibujar Línea
        ctx.beginPath();
        ctx.strokeStyle = '#00f2ff';
        ctx.lineWidth = 2;
        
        let stepX = canvas.width / (maxPoints - 1);
        
        for(let i=0; i<dataPoints.length; i++) {
            let x = i * stepX;
            // Mapear valor 0-200 a altura del canvas
            let y = canvas.height - (dataPoints[i] / 200 * canvas.height);
            if(i===0) ctx.moveTo(x, y);
            else ctx.lineTo(x, y);
        }
        ctx.stroke();

        // Efecto relleno debajo
        ctx.lineTo(canvas.width, canvas.height);
        ctx.lineTo(0, canvas.height);
        ctx.fillStyle = 'rgba(0, 242, 255, 0.1)';
        ctx.fill();
    }
    
    setInterval(drawChart, 200); // Actualizar gráfica rápido

    // --- 2. LÓGICA DE LOS LOGS FALSOS ---
    const logContainer = document.getElementById('logContainer');
    const attacks = [
        { msg: "SSH Brute Force attempt from 192.168.1.45", type: "crit" },
        { msg: "Port 80 scan detected", type: "warn" },
        { msg: "SQL Injection blocked on /login.php", type: "crit" },
        { msg: "User 'admin' logged in successfully", type: "ok" },
        { msg: "Firewall blocked packet TCP/445", type: "warn" },
        { msg: "System backup initiated", type: "info" }
    ];

    function addLog() {
        const randomLog = attacks[Math.floor(Math.random() * attacks.length)];
        const div = document.createElement('div');
        div.className = 'log-item';
        
        let color = '#ccc';
        let prefix = '[INFO]';
        
        if(randomLog.type === 'crit') { color = '#ff3333'; prefix = '[ALERT]'; }
        if(randomLog.type === 'warn') { color = '#ffcc00'; prefix = '[WARN]'; }
        if(randomLog.type === 'ok') { color = '#00ff41'; prefix = '[OK]'; }

        div.innerHTML = `<span style="color:${color}">${prefix}</span> <span>${randomLog.msg}</span> <span style="font-size:0.7em; color:#666">${new Date().toLocaleTimeString()}</span>`;
        
        logContainer.prepend(div); // Añadir al principio
        
        // Limitar a 10 logs visibles
        if(logContainer.children.length > 10) {
            logContainer.removeChild(logContainer.lastChild);
        }
    }

    setInterval(addLog, 2000);

    // --- 3. INICIALIZACIÓN DEL TRADUCTOR ---
    function googleTranslateElementInit() {
        new google.translate.TranslateElement({
            pageLanguage: 'es', includedLanguages: 'en,ca,fr,de,it,pt,ru,zh-CN,ja', layout: google.translate.TranslateElement.InlineLayout.SIMPLE, autoDisplay: false
        }, 'google_translate_element');
    }
  </script>
  
  <script type="text/javascript" src="//translate.google.com/translate_a/element.js?cb=googleTranslateElementInit"></script>
</body>
</html>
